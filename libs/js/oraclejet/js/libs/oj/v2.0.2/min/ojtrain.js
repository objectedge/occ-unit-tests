/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
/*
 Copyright 2013 jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
*/
define(["ojs/ojcore","jquery","ojs/ojcomponentcore"],function(a,f){(function(){a.ya("oj.ojTrain",f.oj.baseComponent,{version:"1.0.0",defaultElement:"\x3cdiv\x3e",widgetEventPrefix:"oj",options:{steps:[],selected:"",optionChange:null,beforeDeselect:null,deselect:null,beforeSelect:null,select:null},cf:0,zb:null,_ComponentCreate:function(){this._super();this.G0()},G0:function(){var b=this.options,a=b.steps;this.cf=a.length;this.su=f("\x3cdiv class\x3d'oj-train-wrapper'\x3e\x3c/div\x3e");this.su.appendTo(this.element);
this.WA=f("\x3cdiv class\x3d'oj-train-connector-wrapper'\x3e\x3c/div\x3e");this.WA.appendTo(this.su);var c=this.element.attr("class");(this.$0=null!=c&&0<=c.indexOf("oj-train-stretch"))&&this.WA.css("padding","0 "+100/(2*this.cf)+"%");this.qU=f("\x3cdiv class\x3d'oj-train-connector'\x3e\x3c/div\x3e");this.qU.appendTo(this.WA);this.bf=f("\x3cul\x3e");this.bf.addClass("oj-train-step-list");this.SH=f("\x3cdiv class\x3d'oj-train-connector-fill'\x3e\x3c/div\x3e");this.SH.appendTo(this.WA);this.Nla();this.Ej=
this.At(b.selected);-1===this.Ej&&a[0]&&a[0].id&&(this.Ej=0,b.selected=a[0].id);for(b=0;b<this.cf;b++)a=f("\x3cli\x3e").addClass("oj-train-step-list-item").attr({id:this.zb[b][1]}),a.appendTo(this.bf),this.Sca(b),this.Vca(b),this.Rca(b),this.Tca(b),this.$0&&a.css("width",100/this.cf+"%");this.SH.css({width:(this.cf-1===this.Ej?100:100/(2*(this.cf-1))+this.Ej/(this.cf-1)*100)+"%"});this.bf.appendTo(this.su);this.element.addClass("oj-train")},Nla:function(){var b=this.options;this.zb=[];for(var a=0;a<
this.cf;a++){var c=b.steps[a];this.zb[a]=Array(5);this.zb[a][0]=c.label?c.label:null;this.zb[a][1]=c.id?c.id:null;this.zb[a][2]=c.disabled?!0:!1;this.zb[a][3]=c.visited?!0:!1;this.zb[a][4]=c.messageType?c.messageType:null}},Rca:function(b){var a=f("\x3cdiv/\x3e").addClass("oj-train-button"),c=f("\x3cspan/\x3e"),e=this,g="";if(this.zb[b]){var h=this.zb[b][3],k=this.zb[b][2];this.Ej===b?(a.addClass("oj-selected"),g=" current "):h&&!k?(a.addClass("oj-visited"),g=" visited "):h||k?a.addClass("oj-disabled"):
(a.addClass("oj-default"),g=" not visited ");this.zb[b][2]||this.Ej===b||(this._hoverable(a),a.on("click"+this.eventNamespace,function(b){e.vB("selected",e.options.selected,this.parentNode.parentNode.id,b);e.refresh()}));h=this.bf.children().eq(b).find(".oj-train-button-connector");1<=h.length&&h.children().remove();h.append(a);c.text(g);c.addClass("oj-helper-hidden-accessible");this.bf.children().eq(b).find("a").append(c)}},Tca:function(b){var a=f("\x3cdiv/\x3e").addClass("oj-train-icon"),c=f("\x3cspan/\x3e"),
e="",g=this;if(this.zb[b]){var h=this.zb[b][4];"confirmation"===h?(a.addClass("oj-confirmation"),e=" Confirmation "):"info"===h?(a.addClass("oj-info"),e=" Info "):"error"===h?(a.addClass("oj-error"),e=" Error "):"fatal"===h?(a.addClass("oj-error"),e=" Error "):"warning"===h&&(a.addClass("oj-warning"),e=" Warning ");var k=this.bf.children().eq(b).find(".oj-train-button");1<=k.children().length&&k.children().remove();this.zb[b][2]||this.Ej===b||(this._hoverable(a),a.on("click"+this.eventNamespace,function(b){g.vB("selected",
g.options.selected,this.parentNode.parentNode.parentNode.id,b);g.refresh()}));null!=h&&(c.text(e),c.addClass("oj-helper-hidden-accessible"),this.bf.children().eq(b).find("a").append(c),k.append(a))}},vB:function(b,a,c,e){b={option:b,fromStep:this.getStep(a),toStep:this.getStep(c),optionMetadata:{writeback:e?"shouldWrite":"shouldNotWrite"}};!1!==this._trigger("beforeDeselect",e,b)&&!1!==this._trigger("beforeSelect",e,b)&&(a=this.At(a),-1!==a&&(this.options.steps[a].visited=!0),this._trigger("deselect",
e,b),this.option("selected",c,{_context:{originalEvent:e,Wa:!0}}),this._trigger("select",e,b))},Vca:function(b){var a=f("\x3cdiv/\x3e");a.addClass("oj-train-button-connector");this.zb[b]&&(b<=this.Ej&&a.addClass("oj-train-fill"),b=this.bf.children().eq(b).children(),a.insertBefore(b))},Sca:function(b){var a=this;if(this.zb[b]){var c=f("\x3cdiv/\x3e").addClass("oj-train-label-wrapper"),e=f("\x3ca\x3e");e.text(this.zb[b][0]);var g=this.zb[b][2];c.append(e);e.addClass("oj-train-label");b===this.Ej?e.addClass("oj-selected"):
this.zb[b][3]&&!g?e.addClass("oj-visited"):g&&e.addClass("oj-disabled");g||(e.attr("href","#"),this._hoverable(e),e.on("click keydown"+this.eventNamespace,function(b){if(b.keyCode===f.ui.keyCode.ENTER||"click"===b.type)b.preventDefault(),a.vB("selected",a.options.selected,this.parentNode.parentNode.id,b),a.refresh(),b.keyCode===f.ui.keyCode.ENTER&&a.Ik(this.parentNode.parentNode.id)}));e=this.bf.children().eq(b).children();1<=e.length&&e[0].remove();this.bf.children().eq(b).append(c)}},At:function(b){for(var a=
0;a<this.cf;a++)if(this.zb[a]&&this.zb[a][1]===b)return a;return-1},getStep:function(b){for(var a=0;a<this.cf;a++)if(this.zb[a]&&this.zb[a][1]===b)return jQuery.extend({},this.options.steps[a]);return null},nextSelectableStep:function(){for(var b=this.At(this.options.selected);b<this.cf;b++)if(b+1<this.cf&&this.zb[b+1]&&!this.zb[b+1][2])return this.zb[b+1][1];return null},previousSelectableStep:function(){for(var b=this.At(this.options.selected);0<=b;b--)if(this.zb[b-1]&&!this.zb[b-1][2])return this.zb[b-
1][1];return null},setStep:function(b){if(b.id){var a=this.getStep(b.id),c=this.At(b.id);-1!==c&&(c=this.options.steps[c],b.label&&(a[0]=b.label,c.label=b.label),"boolean"===typeof b.disabled&&(a[2]=b.disabled,c.disabled=b.disabled),"boolean"===typeof b.visited&&(a[3]=b.visited,c.visited=b.visited),b.messageType&&(a[4]=b.messageType,c.messageType=b.messageType));this.refresh()}},_setOptions:function(b){this._super(b);this.refresh()},_setOption:function(b,a,c){"selected"===b&&this.options.selected&&
this.zb&&this.zb[this.Ej]&&this.vB("selected",this.zb[this.Ej][1],a,null);this._super(b,a,c)},refresh:function(){this._super();this._destroy();this.G0()},_destroy:function(){this.bf.children().each(function(){f(this).remove()});this.element.removeClass("oj-train");this.element.find(".oj-train-wrapper").remove();this.element.find(".oj-train-connector-wrapper").remove();this.element.find(".oj-train-step-list").remove();this.element.find(".oj-train-step-list").remove();this._super()},Ik:function(b){b=
this.At(b);for(var a=0;a<this.cf;a++)if(this.zb[(b+a+1)%this.cf]&&!this.zb[(b+a+1)%this.cf][2]){this.bf.children().eq((b+a+1)%this.cf).find(".oj-train-label").focus();break}},getNodeBySubId:function(b){if(null===b)return this.element?this.element[0]:null;var a=b.index;if("number"!==typeof a||0>a||a>=this.cf)return null;switch(b.subId){case "oj-train-step":return this.bf.children().eq(a)[0];case "oj-train-button":return this.bf.children().eq(a).find(".oj-train-button")[0];case "oj-train-button-connector":return this.bf.children().eq(a).find(".oj-train-button-connector")[0];
case "oj-train-connector":return this.qU;case "oj-train-connector-fill":return this.SH;case "oj-train-icon":return this.bf.children().eq(a).find(".oj-train-icon")[0];case "oj-train-label":return this.bf.children().eq(a).find(".oj-train-label")[0]}return null},getSubIdByNode:function(a){for(var d=this.zb?this.zb.length:0,c=0;c<d;c++){var e={subId:"oj-train-step",index:c};if(a===this.getNodeBySubId(e))return e}return null}})})()});