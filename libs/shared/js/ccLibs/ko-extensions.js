define("koExtensions",["knockout","CCi18n","currencyHelper","ccDate","ccImageZoom","ccNumber","numberFormatHelper","ccConstants","moment","jqueryui","bootstrapDatePicker","bootstrapTimePicker","tagsInput","spectrumColorPicker","bootstrap","chosen","ojs/ojcore","ojs/ojvalidation"],function(e,t,n,a,r,o,i,s,l){"use strict";function c(){function e(e,n){for(var a=0,r=n.length;a<r;a+=1)if(t(e,n[a]))return a;return-1}function t(e,t){return e===t||void 0!==e&&void 0!==t&&(null!==e&&null!==t&&(e.constructor===String?e+""==t+"":t.constructor===String&&t+""==e+""))}window.Select2.class.multi.prototype.skipDuplicateCheck=!0,window.Select2.class.multi.prototype.updateSelection=function(t){var n=[],a=[],r=this;window.Select2.class.multi.prototype.skipDuplicateCheck||($(t).each(function(){e(r.id(this),n)<0&&(n.push(r.id(this)),a.push(this))}),t=a),this.selection.find(".select2-search-choice").remove(),$(t).each(function(){r.addSelectedChoice(this)}),r.postprocessResults()},window.Select2.class.multi.prototype.setVal=function(t){var n;this.select?this.select.val(t):(n=[],window.Select2.class.multi.prototype.skipDuplicateCheck||($(t).each(function(){e(this,n)<0&&n.push(this)}),this.opts.element.val(0===n.length?"":n.join(this.opts.separator))))}}e.bindingHandlers.select2={prependLabel:function(e){if($(e)[0].labels&&$(e)[0].labels.length>0){var t=$(" <span />").attr("class","cc-reader-text").html($(e)[0].labels[0].innerHTML);$(e).select2("container").find(".select2-chosen:first-child").prepend(t)}},init:function(n,a,r){var o,i,s,l,c=a(),u=r(),d=u.lookupKey;l=e.bindingHandlers.select2,void 0!==c.ccFormatInputTooShortKey&&null!==c.ccFormatInputTooShortKey||(c.ccFormatInputTooShortKey="ns.common:resources.select2FormatInputTooShort"),void 0!==c.ccFormatInputTooLongKey&&null!==c.ccFormatInputTooLongKey||(c.ccFormatInputTooLongKey="ns.common:resources.select2FormatInputTooLong"),void 0!==c.ccFormatSelectionTooBigKey&&null!==c.ccFormatSelectionTooBigKey||(c.ccFormatSelectionTooBigKey="ns.common:resources.select2SelectionTooBig"),void 0!==c.ccFormatNoMatches&&null!==c.ccFormatNoMatches||(c.ccFormatNoMatches=t.t("ns.common:resources.select2FormatNoMatches")),void 0!==c.ccFormatLoadMore&&null!==c.ccFormatLoadMore||(c.ccFormatLoadMore=t.t("ns.common:resources.select2LoadMore")),void 0!==c.ccFormatSearching&&null!==c.ccFormatSearching||(c.ccFormatSearching=t.t("ns.common:resources.select2Searching")),void 0!==c.ccPlaceholderAdjustWidth&&null!==c.ccPlaceholderAdjustWidth||(c.ccPlaceholderAdjustWidth=!0),c.formatInputTooShort=function(e,n){var a=n-e.length,r=t.t(c.ccFormatInputTooShortKey,{numberUnder:a});return r},c.formatInputTooLong=function(e,n){var a=e.length-n,r=t.t(c.ccFormatInputTooLongKey,{numberOver:a});return r},c.formatSelectionTooBig=function(e){var n=t.t(c.ccFormatSelectionTooBigKey,{limit:e});return n},c.formatNoMatches=function(){return c.ccFormatNoMatches},c.formatLoadMore=function(e){return c.ccFormatLoadMore},c.formatSearching=function(){return c.ccFormatSearching},$(n).select2(c),$(n).select2("container").find(".select2-search-choice-close").each(function(e,n){$(n).html('<span class="cc-reader-text">'+t.t("ns.common:resources.removeText")+"</span>").attr("tabindex",0)}),$(n).select2("container").find(".select2-choices").attr("aria-label",t.t("ns.common:resources.ariaSelectedOptionsText")),$(".select2-results").attr("aria-label",t.t("ns.common:resources.ariaAvailableOptionsText")),"undefined"!=typeof u.select2.placeholder&&$(n).attr("placeholder",u.select2.placeholder),"undefined"!=typeof u.select2.ccEnabled&&$(n).select2("enable",u.select2.ccEnabled);var p,f,b,m=!1;d&&(p=e.utils.unwrapObservable(u.value),$(n).select2("data",e.utils.arrayFirst(c.data.results,function(e){return e[d]===p}))),e.utils.domNodeDisposal.addDisposeCallback(n,function(){$(n).select2("destroy")}),p=r().value,f=r().valueUpdated,m=r().isPreselect,b=r().selectedOptions,p&&p.isModified&&p.isModified.subscribe(function(e){e&&$(n).prop("required")&&!p.isValid()?$($(n).select2("container")).addClass("invalid"):$($(n).select2("container")).removeClass("invalid")}),p&&p.subscribe(function(e){$(n).prop("required")&&!p.isValid()?$($(n).select2("container")).addClass("invalid"):$($(n).select2("container")).removeClass("invalid")}),o=!1,f?(m&&b&&f(b),$(n).on("change",function(){o||(o=!0,f($(n).val()),o=!1)})):p&&e.isObservable(p)&&$(n).on("change",function(){o||(o=!0,p($(n).val()),o=!1)}),p&&e.isObservable(p)&&$(n).on("select2-blur",function(e){$(n).val(p()).trigger("change")}),$(n).on("select2-open select2-close",function(e){u.select2.ccHideDrop&&$(".select2-drop").toggleClass("cc-select2-hideResults")}),$(n).on("change",function(e){$(n).select2("container").find(".select2-search-choice-close").each(function(e,n){$(n).html('<span class="cc-reader-text">'+t.t("ns.common:resources.removeText")+"</span>").attr("tabindex",0)}),n.selectedOptions&&n.selectedOptions[0]&&n.selectedOptions[0].label&&$(n).select2("container").find(".select2-chosen").attr("title",n.selectedOptions[0].label),l.prependLabel(n)}),"undefined"!=typeof u.select2.placeholder&&u.select2.ccPlaceholderAdjustWidth&&(i=$("<div />").attr({id:"cc-select2-placeholder-tester"}).text(u.select2.placeholder),$("body").append(i),s=$("#cc-select2-placeholder-tester").width()+30,$("body").remove("#cc-select2-placeholder-tester"),$(n).prev(".select2-container").find(".select2-input").attr("placeholder",u.select2.placeholder).css({"min-width":s+"px","max-width":s+"px"}))},update:function(t,n,a,r){var o,i=a(),s=n(),l=i.select2.initializeDataQuery,c=s.valueUpdated;if(o=e.bindingHandlers.select2,o.prependLabel(t),l){var u=a().value,d=$(t).select2("data");u&&e.isObservable(u)&&(u()&&d&&0===d.length?l(u(),function(e){$(t).select2("data",e),u.valueHasMutated(),u.isModified(!1)},s.includeInvalidItems,d):u()?u()&&d&&d.length>0&&c&&c(d):d&&d.length>0?($(t).select2("data",[]),u.valueHasMutated(),u.isModified(!1)):c&&c([]))}t.selectedOptions&&t.selectedOptions[0]&&t.selectedOptions[0].label&&$(t).select2("container").find(".select2-chosen").attr("title",t.selectedOptions[0].label)}},e.bindingHandlers.select2Tags={init:function(e,n,a){var r,o,i=n();void 0!==i.ccFormatNoMatches&&null!==i.ccFormatNoMatches||(i.ccFormatNoMatches=t.t("ns.common:resources.select2FormatNoMatches")),r=i.ccTagOptions?i.ccTagOptions:null,i.formatNoMatches=function(){return i.ccFormatNoMatches},i.createSearchChoice=function(n){return o=!0,$.each($(e).select2("container").find(".select2-search-choice"),function(e,t){$.trim($(t).text().toLowerCase())==$.trim(n.toLowerCase())&&(o=!1)}),o?{id:$.trim(n),text:$.trim(n)}:void window.setTimeout(function(e){$(".select2-no-results").text(t.t("ns.common:resources.select2NoDuplicateText"))},0)},c(),$(e).select2(i).on("select2-removing",function(t){$.each($(e).select2("container").find(".cc-select2-locked"),function(e,n){$.trim($(n).text())==t.val&&t.preventDefault()})}),$(e).on("change",function(n){$(e).select2("container").find(".select2-search-choice-close").each(function(e,n){$(n).html('<span class="cc-reader-text">'+t.t("ns.common:resources.removeText")+"</span>").attr("tabindex",0)})}),window.Select2.class.multi.prototype.skipDuplicateCheck=!1,r&&(r.lockExisting&&$.each($(e).select2("container").find("ul.select2-choices li.select2-search-choice"),function(e,t){$(t).addClass("cc-select2-locked")}),r.disabled&&$(e).select2("enable",!1),r.sortable&&$(e).select2("container").find("ul.select2-choices").sortable({containment:"parent",start:function(){$(e).select2("onSortStart")},update:function(){$(e).select2("onSortEnd")}}))},update:function(e,t,n,a,r){}},e.bindingHandlers.onRender={init:function(e,t,n,a,r){var o=t();"function"==typeof o&&o(e,a)}},function(){var t,a,r,o,i=200,s=300,l=100,c=200;o=function(e){0===$(e.target).closest(".popover").length&&a()},a=function(){t&&(t.data("bs.popover").tip().off("keydown"),t.popover("destroy"),t=null,$(document).off("click",o),$(document).off("focusin",o))},r=function(e,t){var n,a,r,o;return o=$(window),n=t.top-o.scrollTop(),a=t.left-o.scrollLeft(),n<l||n<c&&"top"===e?r="bottom":(n>o.height()-l||n>o.height()-c&&"bottom"===e)&&(r="top"),a<i||a<s&&"left"===e?r="right":(a>o.width()-i||a>o.width()-s&&"right"===e)&&(r="left"),r||e},e.bindingHandlers.popeditor={init:function(i,s,l,c,u){var d,p,f,b=s(),m=e.observable(!0),v=b.type,h=e.bindingHandlers.tabTrap;if(p={html:!0,trigger:b.trigger||"manual",content:"<div class='"+b.class+"'></div>",container:b.container||"body",placement:b.placement||"right"},d=$(i),b.plgProperty=e.observable(null),"currencyMap"===v){var g={};$.each(b.property(),function(t){g[t]=e.observable(e.utils.unwrapObservable(this)).extend(b.validate),g[t].jetValidation=e.observable(!0)}),b.plgProperty(g)}"currencyMap"!==v&&(b.validate.validatable=!0),f=u.extend({id:b.id,title:b.title,focusElement:b.focusElement,property:e.observable(e.utils.unwrapObservable(b.property)).extend(b.validate),plgProperty:e.observable(e.utils.unwrapObservable(b.plgProperty)).extend(b.validate),enumeratedValues:e.observable(e.utils.unwrapObservable(b.enumeratedValues)),jetValidation:e.observable(!0),currencyHelper:n,priceListGroups:b.priceListGroups,type:b.type,save:function(){if("currencyMap"!==f.type&&f.property.isValid()&&m())return b.property()!=f.property()&&b.property(f.property()),a(),d.filter(":focusable").length>0?d.focus():d.find(":focusable").focus(),f.property.isModified()&&b.property.notifySubscribers(b.property(),"valueSubmitted"),!1;if("currencyMap"===f.type){var e=!1,t=!1;if($.each(f.plgProperty(),function(n){this.isModified()&&(e=this.isModified(),t=this.isValid())}),e&&t)b.property(f.plgProperty()),b.property.notifySubscribers(f.$parent,"valueSubmitted"),f.close();else if(e&&!t)return!1}},close:function(){return a(),d.filter(":focusable").length>0?d.focus():d.find(":focusable").focus(),!1},focus:function(e){f.focusElement?$(e).find(f.focusElement).focus():$(e).find(":focusable").focus(),h.constrain($(".popover.in"))},customJetOptionChangeListener:function(t,n){var a=null,r=e.contextFor(this),o="currencyMap"===r.type;if(a=o?r.plgProperty()[e.dataFor(this).id]:r,a.jetValidation(!0),"messagesShown"===n.option){var i=$(t.target).ojInputText("isValid");i?a.jetValidation(!0):a.jetValidation(!1)}else a.jetValidation(!0)},computedValueWithFractions:e.pureComputed({read:function(){return f.property()},write:function(e){void 0!=e?"number"===v?f.property(e.toFixed(0)):"price"===v&&f.property(e.toFixed(n.currencyObject().fractionalDigits)):f.property(e)}})}),d.click(function(n){var i;if(n.preventDefault(),p.placement=r(b.placement,d.offset()),d.popover(p),i=d.data("bs.popover").tip(),i.hasClass("in"))a(),d.filter(":focusable").length>0?d.focus():d.find(":focusable").focus();else{if(a(),"currencyMap"===f.type){var s={};$.each(b.property(),function(t){s[t]=e.observable(e.utils.unwrapObservable(this)).extend(b.validate),s[t].jetValidation=e.observable(!0)}),b.plgProperty(s),f.plgProperty(e.utils.unwrapObservable(b.plgProperty)).extend(b.validate),$.each(f.plgProperty(),function(e){f.plgProperty()[e].extend({validatable:!0}),f.plgProperty()[e].errors=null,f.plgProperty()[e].isModified(!1),f.plgProperty()[e].forcedModified=!1})}else f.property(e.utils.unwrapObservable(b.property)),f.property.errors=null,f.property.isModified(!1),f.property.forcedModified=!1;i.addClass(b.class),i.children(".popover-content").attr("data-bind","template: {name: '"+b.type+"', templateUrl: 'templates/popeditors', afterRender: focus}"),b.wideMode?(i.children(".popover-title").attr("data-bind","template: {name: 'wide-header', templateUrl: 'templates/popeditors'}"),i.addClass("cc-pop-wide")):i.children(".popover-title").attr("data-bind","template: {name: 'header', templateUrl: 'templates/popeditors'}"),i.keydown(function(e){27===e.which&&(a(),d.filter(":focusable").length>0?d.focus():d.find(":focusable").focus())}),window.setTimeout(function(){$(document).click(o),$(document).focusin(o)},1),d.popover("show"),t=d,e.applyBindingsToDescendants(f,i[0])}})}},e.bindingHandlers.popover={init:function(t,n,i,s){var l,c,u,d=n();c={html:!0,trigger:d.trigger||"click",content:"<div class='"+d.class+"'></div>",container:d.container||"body",placement:d.placement||"right"},l=$(t),u={model:d.model||s,save:function(){if(u.property.isValid())return d.property()!=u.property()&&d.property(u.property()),a(),l.filter(":focusable").length>0?l.focus():l.find(":focusable").focus(),d.property.notifySubscribers(d.property(),"valueSubmitted"),!1},close:function(){return a(),l.filter(":focusable").length>0?l.focus():l.find(":focusable").focus(),!1},focus:function(e){$(e).find(":focusable").focus(),tabTrap.constrain($(".popover.in"))}},l.click(function(t){var n;c.placement=r(d.placement,l.offset()),l.popover(c),n=l.data("bs.popover").tip(),a(),n.hasClass("in")||(n.children(".popover-content").attr("data-bind","template: {name: '"+d.name+"', templateUrl: '"+d.templateUrl+"', afterRender: focus}"),n.keydown(function(){27===event.which&&a()}),window.setTimeout(function(){$(document).click(o),$(document).focusin(o)},1),l.popover("show"),e.applyBindingsToDescendants(u,n[0]))})}}}(),function(){var n,r,o,i,c,u=200,d=300,p=100,f=200,b=!0;i=function(e){0!==$(e.target).closest(".popover").length||c(e.target,"datepicker")||c(e.relatedTarget,"oj-datepicker")||r()},c=function(e,t){if(e)do if(1==e.nodeType&&$(e).is("[class*="+t+"]"))return!0;while((e=e.parentElement)&&void 0!==e&&1==e.nodeType);return!1},r=function(){n&&(n.data("bs.popover").tip().off("keydown"),n.popover("destroy"),n=null,$(document).off("click",i),$(document).off("focusin",i))},o=function(e,t){var n,a,r,o;return o=$(window),n=t.top-o.scrollTop(),a=t.left-o.scrollLeft(),n<p||n<f&&"top"===e?r="bottom":(n>o.height()-p||n>o.height()-f&&"bottom"===e)&&(r="top"),a<u||a<d&&"left"===e?r="right":(a>o.width()-u||a>o.width()-d&&"right"===e)&&(r="left"),r||e},e.bindingHandlers.datepopover={init:function(c,u,d,p){var f,m,v,h,g,w=u(),y=e.bindingHandlers.tabTrap,O=!1;m={html:!0,trigger:w.trigger||"click",content:"<div class='"+w.class+"'></div>",container:w.container||"body",placement:w.placement||"right"},f=$(c),v={toDate:e.observable(e.utils.unwrapObservable(w.toDate)),fromDate:e.observable(e.utils.unwrapObservable(w.fromDate)),toDateLabel:t.t("ns.reporting:resources.toText")+" "+t.t("ns.reporting:resources.date")+":"+t.t("ns.reporting:resources.descriptionToAccessCalender"),fromDateLabel:t.t("ns.reporting:resources.fromText")+" "+t.t("ns.reporting:resources.date")+":"+t.t("ns.reporting:resources.descriptionToAccessCalender"),toDateText:t.t("ns.reporting:resources.toText"),fromDateText:t.t("ns.reporting:resources.fromText"),customDateRangeText:t.t("ns.reporting:resources.customDateRangeText"),errorMessage:w.errorMessage,dataCollectionStartDate:w.dataCollectionStartDate,yesterday:w.yesterday,save:function(e,t){var n=$("#cc-fromDate").ojInputDate("option","placeholder");return n&&(n=n.toUpperCase()),"true"===$("#cc-fromDate").attr("aria-invalid")||"true"===$("#cc-toDate").attr("aria-invalid")?(w.toDate(void 0),w.fromDate(void 0)):(null===v.toDate()?w.toDate(null):w.toDate(l(v.toDate()).toDate()),null===v.fromDate()?w.fromDate(null):w.fromDate(l(v.fromDate()).toDate())),!!(b=w.validation())&&(r(),f.filter(":focusable").length>0?f.focus():f.find(":focusable").focus(),w.toDate.notifySubscribers(w.toDate(),"valueSubmitted"),w.fromDate.notifySubscribers(w.fromDate(),"valueSubmitted"),O=!0,!1)},close:function(){return r(),f.filter(":focusable").length>0?f.focus():f.find(":focusable").focus(),!1},focus:function(e){if(w.initFromDate()&&w.initToDate()){var t=$("#cc-fromDate").ojInputDate("option","placeholder");t&&(t=t.toUpperCase()),$("#cc-fromDate").val(a.formatDateAndTime(w.initFromDate(),null,t,null)),$("#cc-toDate").val(a.formatDateAndTime(w.initToDate(),null,t,null)),w.fromDate(w.initFromDate()),w.toDate(w.initToDate())}$(e).find("#cc-toDate").focus(),$(e).find("#cc-fromDate").focus(),y.constrain($(".popover.in"))}};var x=$(w.container);x.on("hidden.bs.popover",function(){O&&(g=null,h=null,w.initFromDate(null),w.initToDate(null))}),f.click(function(t){var l;t.preventDefault(),m.placement=o(w.placement,f.offset()),f.popover(m),l=f.data("bs.popover").tip(),l.hasClass("in")?(r(),f.filter(":focusable").length>0?f.focus():f.find(":focusable").focus()):(r(),""===w.errorMessage()||void 0===w.errorMessage()?(null==w.toDate()||void 0==w.toDate()?v.toDate(null):v.toDate(a.formatDateAndTime(w.toDate(),null,s.OJET_INPUT_SHORT_DATE_FORMAT,null)),void 0==w.fromDate()||null==w.fromDate()?v.fromDate(null):v.fromDate(a.formatDateAndTime(w.fromDate(),null,s.OJET_INPUT_SHORT_DATE_FORMAT,null)),v.errorMessage=w.errorMessage):(v.toDate(null),v.fromDate(null),g=null,h=null,w.initToDate(null),w.initFromDate(null),w.toDate(null),w.errorMessage(""),w.fromDate(null)),l.css("z-index",w.zIndex),l.css("min-height",w.minHeight),l.css("min-width",w.minWidth),l.children(".popover-title").attr("data-bind","template: {name: 'datepickerHeader', templateUrl: 'templates/reporting'}"),l.children(".popover-content").attr("data-bind","template: {name: '"+w.name+"', templateUrl: '"+w.templateUrl+"', afterRender: focus}"),l.keydown(function(e){27===e.which&&r()}),window.setTimeout(function(){$(document).click(i),$(document).focusin(i)},1),f.popover("show"),n=f,e.cleanNode(l[0]),e.applyBindingsToDescendants(v,l[0]))})}},e.bindingHandlers.popover={init:function(t,n,a,s){var l,c,u,d=n();c={html:!0,trigger:d.trigger||"click",content:"<div class='"+d.class+"'></div>",container:d.container||"body",placement:d.placement||"right"},l=$(t),u={model:d.model||s,save:function(){if(u.property.isValid())return d.property()!=u.property()&&d.property(u.property()),r(),l.filter(":focusable").length>0?l.focus():l.find(":focusable").focus(),d.property.notifySubscribers(d.property(),"valueSubmitted"),!1},close:function(){return r(),l.filter(":focusable").length>0?l.focus():l.find(":focusable").focus(),!1},focus:function(e){$(e).find(":focusable").focus(),tabTrap.constrain($(".popover.in"))}},l.click(function(t){var n;c.placement=o(d.placement,l.offset()),l.popover(c),n=l.data("bs.popover").tip(),r(),n.hasClass("in")||(n.children(".popover-content").attr("data-bind","template: {name: '"+d.name+"', templateUrl: '"+d.templateUrl+"', afterRender: focus}"),n.children(".popover-title").attr("data-bind","template: {name: 'datepickerHeader', templateUrl: 'templates/reporting'}"),n.keydown(function(){27===event.which&&r()}),window.setTimeout(function(){$(document).click(i),$(document).focusin(i)},1),l.popover("show"),e.applyBindingsToDescendants(u,n[0]))})}}}(),function(){var t,n,a,r=1052,o=null;e.bindingHandlers.modal={init:function(i,l,c){var u,d,p,f,b,m,v,h,g,w,y,O,x,D,T=null,k="cc-modal-focus-out-active",C=l().focusFallback?l().focusFallback.split(","):null;d=$(window),u=$(i),p=u.find(".modal-body");var S=!!d[0].chrome&&!!d[0].chrome.webstore;x=function(){$(i).on("keydown.modal.cc",":text",function(e){var t=e.which||e.charCode||e.keyCode;if(27==t)return!1})},D=function(){$(i).off("keydown.modal.cc",":text")},f=function(){var e,t=0;$("body").prepend($("<div />").attr("id","cc-modalTester")),u.find(".modal-content").children().each(function(){this!==p[0]&&$(this).clone().appendTo("#cc-modalTester")}),t=$("#cc-modalTester").outerHeight(),$("#cc-modalTester").remove(),e=d.width()>767?.11*d.height():11,p.css({"max-height":Math.max(128,d.height()-t-e)})},b=function(e){$(e).find(".cc-focus-target").length>0?$.inArray($(e).find(".cc-focus-target")[0],$(e).find(":tabbable"))===-1?void 0!==$(e).find(".cc-focus-target :tabbable")[0]&&$(e).find(".cc-focus-target :tabbable")[0].focus():$(e).find(".cc-focus-target")[0].focus():$(e).find(":tabbable")[0]&&$(e).find(":tabbable")[0].focus()},g=function(e){1===u.has(document.activeElement).length&&(T=!0,$(document.activeElement).addClass(k))},w=function(e){T=!1,$("."+k).removeClass(k)},y=function(e){T&&e.preventDefault(),$("."+k).focus().removeClass(k)},O=function(e){T=!1},u.on("focusin",function(e){e.stopPropagation()}),u.on("show.bs.modal",function(e){$(e.target).hasClass("modal")&&(u.data("alreadyOpen")!==!0&&(u.data("alreadyOpen",!0),setTimeout(function(){u.data("bs.modal").$backdrop.css({"z-index":r-10}),u.css({"z-index":r}),t=r,r+=20,f()},1)),d.resize(f),$("body").addClass("no-scroll"),m=!0,1===$(e.relatedTarget).length&&(v=$(e.relatedTarget),v.addClass(s.MODAL_CLOSE_FOCUS),v.attr("id")&&(h=v.attr("id"))))}),u.on("shown.bs.modal",function(e){b(u),S&&(u.on("focusout",g),u.on("focus mousedown",O),u.on("keyup.dismiss.bs.modal",w),u.find("button, a").on("click",O),u.on("hide.bs.modal",y)),x()}),u.on("hide.bs.modal",function(){u.find(".modal-body").scrollTop(0)}),u.on("hidden.bs.modal",function(e){if($(e.target).hasClass("modal")){if(r-=20,n=r-20,m=!1,a=0,o=null,u.data("alreadyOpen",!1),D(),d.off("resize",f),S&&(u.off("focusout",g),u.off("focus mousedown",O),u.off("keyup.dismiss.bs.modal",w),u.find("button, a").off("click",O),u.off("hide.bs.modal",y)),T=null,u.find(".cc-curtain")&&u.find(".cc-curtain").remove(),$(i).css("left","0px"),0===$("body .modal.in").length){setTimeout(function(){$("body").removeClass("no-scroll")},0);var t=null;null!==C&&$.each(C,function(e,n){if(0!==$(n).length)return t=n,!1}),0!==$(s.MODAL_CLOSE_FOCUS_CLASS).length?($(s.MODAL_CLOSE_FOCUS_CLASS).focus(),$(s.MODAL_CLOSE_FOCUS_CLASS).removeClass(s.MODAL_CLOSE_FOCUS)):$("#"+h).length>0?$("#"+h).focus():null!==t&&window.setTimeout(function(){$(t).focus()},10)}$.each($(".modal"),function(e,t){"block"===$(t).css("display")&&$(t).css("z-index")>a&&(a=$(t).css("z-index"),o=$(t))}),b(o)}}),e.utils.domNodeDisposal.addDisposeCallback(i,function(){u.modal("hide")})}}}(),e.bindingHandlers.tagsInput={init:function(e,t,n){},update:function(t,n,a,r,o){var i,s,l,c,u=e.utils.unwrapObservable(n()),d=$(t).find("input"),p=",",f=e.utils.unwrapObservable(u.defaultText)?e.utils.unwrapObservable(u.defaultText):"Add item",b=e.utils.unwrapObservable(u.height)?e.utils.unwrapObservable(u.height):"100px",m=e.utils.unwrapObservable(u.width)?e.utils.unwrapObservable(u.width):"300px",v=e.utils.unwrapObservable(u.minChars)?e.utils.unwrapObservable(u.minChars):"0",h=e.utils.unwrapObservable(u.maxChars)?e.utils.unwrapObservable(u.maxChars):"",g=!e.utils.unwrapObservable(u.caseInsensitive)||e.utils.unwrapObservable(u.caseInsensitive),w=e.utils.unwrapObservable(u.isInteractive)!==!1||e.utils.unwrapObservable(u.isInteractive);if(d.val()&&0!==d.val().length){l=$(t).find("input").val();setTimeout(function(){$(".tagsinput .tag").addClass("cc-locked-tag").find("a").remove()},0)}$(d).tagsInput({defaultText:f,hide:!0,height:b,width:m,minInputWidth:e.utils.unwrapObservable(u.minInputWidth)||"149px",minChars:v,maxChars:h,interactive:w,onRemoveTag:function(e){if(c=$(d)[0].id,l&&l.indexOf(e)!==-1&&$("#"+c).importTags(l),l)for(var t=0;t<l.split(",").length;t++){var n=$("#"+c+"_tagsinput .tag")[t];$(n).addClass("cc-locked-tag").find("a").remove()}},onChange:function(e,a){n().list($(t).find("input").val())},onAddTag:function(e){if(g){var t=d.val().split(","),n=$(d)[0].id;if(t.length>1)for(var a=0;a<t.length-1;a+=1)if(e.toLowerCase()===t[a].toLowerCase()){i="",s=$(this).val().split(p),$("#"+n+"_tagsinput .tag").remove();for(var r=0;r<s.length;r+=1)0!==s[r].indexOf(e)&&(i=i+p+s[r]);$("#"+n).importTags(i),$("#"+n+"_tag").focus(),$("#"+n+"_tag").val(e),$("#"+n+"_tag").addClass("not_valid")}}}}),e.utils.unwrapObservable(u.isInteractive)===!1&&($(d).next().addClass("cc-tagsInput-readOnly"),$(d).next().find("div").remove())}},e.bindingHandlers.datepicker={init:function(t,n,a){var r=a().dpOptions||{},o=r.language?r.language:"en",i=e.bindingHandlers.datepicker;require(["bootstrapDatePickerLocales/bootstrap-datepicker."+o],function(e){i.loadDatePicker.call(i,t,n,a,r)},function(e){var s;s=o.indexOf("-")!==-1?o.split("-")[0]:"en",require(["bootstrapDatePickerLocales/bootstrap-datepicker."+s],function(e){i.loadDatePicker.call(i,t,n,a,r)},function(e){i.loadDatePicker.call(i,t,n,a,r)})})},loadDatePicker:function(t,n,r,o){var i,s,l,c,u,d,p,f=1===$(t).parents(".modal").length;f?(i="",s=$(t).parents(".tab-pane")?$(t).parents(".tab-pane"):$(t).parents(".modal-body")):i=$(t).closest(".row")[0].nextElementSibling;var b=e.utils.unwrapObservable(r().format);!b&&o.format||(o.format=a.getDateFormat(b?b:"short").toLowerCase()),$(t).datepicker(o).on("show",function(e){$.each($("body .datepicker.dropdown-menu"),function(t,n){void 0!==$(n).attr("style")&&"none"!=$(n).css("style")&&null!==i&&$(n).css({position:"absolute",top:"35px",left:"0px"}).appendTo($(e.target).parent())}),c=$(t).parents(".form-group").position().top+$(t).parents(".form-group").outerHeight(!0),u=c+240,f?(l=s.height(),u>l&&(d=u-l,s.css({height:l+d+"px"})),p=$(t).parents(".modal-body").scrollTop()+$(t).closest(".form-group").offsetParent().position().top,$(t).parents(".modal-body").scrollTop($(t).closest(".form-group").position().top+p)):(l=$(t).parents(".form-group").offsetParent().outerHeight(!0),u>l&&(d=u-l,$(t).parents(".form-group").offsetParent().css({})))}).on("changeDate",function(e){var a=n();a(e.date),$(t).datepicker("setValue",e.date)}).on("dphide",function(){f?s.css({height:"auto"}):$(t).parents(".form-group").offsetParent().css({height:"auto"})}),e.utils.domNodeDisposal.addDisposeCallback(t,function(){$(t).datepicker("remove")})},update:function(t,n,a){var r=e.utils.unwrapObservable(a().value);if(r){var o=new Date(r);isNaN(o)||(a().value(o),$(t).datepicker("setDate",new Date(o.getTime()+6e4*o.getTimezoneOffset())))}}},e.bindingHandlers.timepicker={init:function(t,n,a){var r,o=a().Options||{};$(t).timepicker(o).on("show.timepicker",function(e){$(t).timepicker("setDefaultTime","current")}),$(t).timepicker(o).on("focus.timepicker",function(e){$(t).timepicker("showWidget")}),r=e.utils.unwrapObservable(n()),$(t).timepicker(o).on("changeTime.timepicker",function(e){var t=n();t(e.time.value)}),e.utils.domNodeDisposal.addDisposeCallback(t,function(){$(t).timepicker("remove")})}},e.bindingHandlers.spectrum={init:function(n,a,r){var o=r().defaultSettings||{};o.cancelTextKey&&(o.cancelText=t.t("ns.common:resources."+o.cancelTextKey)),o.chooseTextKey&&(o.chooseText=t.t("ns.common:resources."+o.chooseTextKey));var i="#000000",s=function(){var e=$(n).spectrum("get");"function"==typeof e.toHex&&(i="#"+e.toHex());var t=a();i!==t()&&t(i)},l=function(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n};o.hide=s,o.clickoutFiresChange=!0;var c="spectrum-input";if(n.id)c=n.id+"-spectrum-input";else{var u=new Date;c=l(u.getFullYear(),4)+l(u.getMonth()+1,2)+l(u.getDay(),2)+l(u.getHours(),2)+l(u.getMinutes(),2)+l(u.getSeconds(),2)+l(u.getMilliseconds(),3)+"-spectrum-input"}var d="class-"+c;o.className=d,$(n).spectrum(o);var p=$("<label>Color</label>",{htmlFor:c});p.attr("for",c),p.attr("class","cc-reader-text"),p.text(t.t("ns.common:resources.colorPickerInputLabel"));var f=$("."+d),b=f.find(".sp-cancel"),m=f.find(".sp-choose"),v=f.find(".sp-input-container");v.prepend(p);var h=f.find(".sp-input");h.attr("id",c);var g=e.utils.unwrapObservable(a());$(n).spectrum("set",g),e.utils.registerEventHandler(n,"change",s);var w=$(n).next(".sp-replacer");w.removeAttr("tabindex");var y=$("<a></a>",{href:"#"});w.wrap(y),e.utils.domNodeDisposal.addDisposeCallback(n,function(){var e=$(n).spectrum("get");"function"==typeof e.toHex&&(i="#"+e.toHex()),$(n).spectrum("destroy")}),y=$(n).next("a"),b.click(function(){return y.focus(),!0}),m.click(function(){return y.focus(),!0}),y.click(function(){var e=n.disabled;if(!e){var t=$(n).spectrum("container");t.appendTo(y),$(n).spectrum("toggle")}return!1})},update:function(t,n){var a=e.utils.unwrapObservable(n());$(t).spectrum("set",a)}},e.bindingHandlers.slider={init:function(t,n,a){var r=a().sliderOptions||{},o=e.utils.unwrapObservable(n());r.value=o,r.change=function(e,t){var a=n();a(t.value)},r.liveUpdate&&(r.slide=r.change),$(t).slider(r),e.utils.domNodeDisposal.addDisposeCallback(t,function(){$(t).slider("destroy")}),e.utils.registerEventHandler(t,"slidestop",function(e,t){var a=n();a(t.value)})},update:function(t,n,a){var r=a().sliderOptions||{},o=e.utils.unwrapObservable(n());isNaN(o)&&(o=r.defaultValue||0),$(t).slider("value",o),$(t).slider("option",a().sliderOptions)}},e.bindingHandlers.chosen={truncate:function(e){var t,n,a;t=$(".chosen-container").find("span").outerWidth(!0)+5,n=$(".chosen-container").width(),t>n&&e&&(a=$(".chosen-container").find("span").html().split(e),a.length>1&&$(".chosen-container").find("span").text("... "+e+" "+a[a.length-1]))},addAccessibility:function(e){var n=e.find("a.search-choice-close");$.each(n,function(){0===$(this).find(".cc-reader-text").length&&($(this).append($("<span />").attr("class","cc-reader-text").text(t.t("ns.common:resources.removeText"))),$(this).attr("tabindex","0"),$(this).on("keyup",function(t){13===t.keyCode&&($(this).trigger("click"),$(e.find(".search-field input")).focus())}))})},init:function(n,a,r,o,i){var s,l,c,u,d,p,f,b,m=e.utils.unwrapObservable(a()),v=!!m.allSelectedMessage&&m.allSelectedMessage;e.bindingHandlers.options.init(n,function(){return m.values},r,o,i),c=e.bindingHandlers.chosen,$(n).addClass("chosen-select"),$(n).chosen(m.options).trigger("chosen:ready"),u=$(n).next(),f=$(n).attr("id")+"-search-field",b=$(n).attr("data-placeholder")?$(n).attr("data-placeholder"):t.t("ns.common:resources.chosenSearchFieldDefaultLabel"),d=u.find(".search-field"),p=$("<label />").attr("class","cc-reader-text").attr("for",f).text(b),d.find("input").attr("id",f),d.prepend(p),$(n).chosen().change(function(){c.addAccessibility(u)}),$(n).on("chosen:showing_dropdown",function(){window.setTimeout(function(){0===u.find("li.active-result").length?v?u.find(".chosen-results").append($("<li />").attr("class","cc-chosen-message").html(v)):u.find(".chosen-drop").addClass("hide"):($(".cc-chosen-message").remove(),u.find(".chosen-drop").removeClass("hide"))},0)});var h=n.id+"-search";$(".chosen-search input").attr("id",h),l=r().value,s=!1,l&&e.isObservable(l)&&$(n).on("change",function(){s||(s=!0,l($(n).val()),s=!1)}),m.truncate&&$(n).on("change",c.truncate.bind(c,m.truncate))},update:function(t,n,a,r,o){var i,s,l,c=e.utils.unwrapObservable(n());$(".chosen-results").attr("tabindex","0"),l=$(t).next(),e.bindingHandlers.options.update(t,function(){return c.values},a,r,o),s=e.bindingHandlers.chosen,a().value?$(t).val(e.utils.unwrapObservable(a().value)):a().selectedOptions&&$(t).val(e.utils.unwrapObservable(a().selectedOptions)),$(t).trigger("chosen:updated"),s.addAccessibility(l),c.truncate&&(i=$(t).parents(".modal").attr("id")?"#"+$(t).parents(".modal").attr("id"):"",i?$(i).on("shown.bs.modal",function(){s.truncate(c.truncate)}):s.truncate(c.truncate))}},e.bindingHandlers.textCheck={update:function(t,a,r,o,s){var l=e.utils.unwrapObservable(a()),c=e.utils.unwrapObservable(l.text),u=e.utils.unwrapObservable(l.type),d=e.utils.unwrapObservable(l.prePend),p=e.utils.unwrapObservable(l.nullReplace),f=e.utils.unwrapObservable(l.prependNull);if(!c&&0!==c||isNaN(parseFloat(c)))c=(d&&f?d:"")+(p?p:"");else if("price"==u||"percent"==u||"number"==u||"digit"==u){var b;b="string"==typeof c?parseFloat(c):c,"number"==typeof c||"string"==typeof c&&c.trim().length>0?"price"==u?c=b<0?"-"+(d||"")+n.handleFractionalDigitsAndLocale(Math.abs(b)):(d||"")+n.handleFractionalDigitsAndLocale(b):"percent"==u?c=(d||"")+i.formatNumber(b,2,"decimal"):"number"==u?c=(d||"")+i.formatNumber(b,2,"decimal"):"digit"==u&&(c=(d||"")+i.formatNumber(b,0,"decimal")):c=(d&&f?d:"")+(p?p:"")}else c=(d||"")+c;e.bindingHandlers.text.update(t,function(){return c})}},e.bindingHandlers.scrollAffix={update:function(t,n){var a,r,o,i,s,l,c,u,d=e.utils.unwrapObservable(n());r=e.utils.unwrapObservable(d.scrollDistance),o=e.utils.unwrapObservable(d.affixPos),i=e.utils.unwrapObservable(d.affixWidth)?e.utils.unwrapObservable(d.affixWidth):null,s=e.utils.unwrapObservable(d.affixMatchElm),l=e.utils.unwrapObservable(d.adjust),c=e.utils.unwrapObservable(d.adjustPos)?e.utils.unwrapObservable(d.adjustPos):null,a=function(){if(u=null,$(window).width()<="992")return $(t).parent().css({
"min-height":"auto"}),$(t).css({position:"",top:"",width:""}),void 0!==l&&$(l).css({"margin-top":"auto"}),!1;if(i)u=i;else{if("undefined"===s||"none"===$(s).css("display"))return!1;u=$(s).outerWidth(!0)}$(window).scrollTop()>r&&null!==u?($(t).css({position:"fixed",top:o,width:u}),$(t).addClass("cc-scrollAffix"),void 0!==l&&$(l).css({"margin-top":c})):($(t).parent().css({"min-height":"auto"}),$(t).css({position:"",top:"",width:""}),$(t).removeClass("cc-scrollAffix"),void 0!==l&&$(l).css({"margin-top":"auto"}))},$(window).scroll(a),$(window).resize(a),e.utils.domNodeDisposal.addDisposeCallback(t,function(){$(window).off("scroll",a),$(window).off("resize",a)})}},e.bindingHandlers.currency={update:function(t,n,a,r,i){var s=e.utils.unwrapObservable(n()),l=parseFloat(s.price),c=s.currencyObj.symbol,u=s.nullReplace,d=s.prependNull,p=s.prependSymbol,f=s.currencyObj.fractionalDigits,b=null;if(p&&(c=p+" "+c),!l&&0!==l||isNaN(parseFloat(l)))$(t).text((c&&d?c:"")+(u?u:""));else{c.match(/^[0-9a-zA-Z]+$/)&&(c+=" "),l=l.toFixed(f),b=o.formatNumber(l,!0,f);var m=b.charAt(0);"-"===m||"+"===m?$(t).text(m+c+b.slice(1)):$(t).text(c+b)}}},e.bindingHandlers.imageSource={init:function(t,n){var a,r,o,i=!1,s=e.utils.unwrapObservable(n());"object"==typeof s&&"IMG"===t.nodeName&&(s.cacheBust&&(i=e.utils.unwrapObservable(s.cacheBust)),a=e.utils.unwrapObservable(s.src),i&&(a=d(a)),r=e.utils.unwrapObservable(s.errorSrc),a&&r&&(o=new Image,o.src=r))},update:function(t,n,a,r,o){var i,s,l,c,u,p,f,b,m=!1,v=e.utils.unwrapObservable(n());if("object"==typeof v&&"IMG"===t.nodeName){v.cacheBust&&(m=e.utils.unwrapObservable(v.cacheBust)),c=e.utils.unwrapObservable(v.src),i=e.utils.unwrapObservable(v.imageType),i||(i="small");var h=[function(e,t){var n;return e.productImages&&e.productImages.length>0&&(n=e.productImages[0].url),n},function(e,t){return e.url},function(e,t){var n,a=c[t+"Image"];return a&&(n=a.url),n},function(e,t){var n;return c instanceof Object&&c[t]&&(n=c[t]),n},function(e,t){var n,a,r,o;return a=e.childSKUs,a&&(n=a[0],n&&(r=n[t+"Image"],r&&(o=r.url))),o},function(e,t){if("string"==typeof e)return e}];if(c)for(;!l&&h.length;)l=h.shift().call(this,c,i);else l=v.errorSrc;return m&&(l=d(l)),u=e.utils.unwrapObservable(v.errorSrc),p=e.utils.unwrapObservable(v.alt),f=e.utils.unwrapObservable(v.errorAlt),b=e.utils.unwrapObservable(v.onerror),u?void(l?(s=new Image,s.onload=function(){t.src=l,t.alt=p?p:""},s.onerror=function(){t.src=u,t.alt=f?f:"",b&&b(t)},s.src=l):(t.src=u,f?t.alt=f:p?t.alt=p:t.alt="",b&&b(t))):(t.src=l,void(t.alt=p?p:""))}}};var u=0;e.bindingHandlers.makeAccess={init:function(n,a){var r,o,i,s=e.utils.unwrapObservable(a());r=$('<span class="cc-reader-text"/>'),s.readerText?r.text(e.utils.unwrapObservable(s.readerText)):s.readerResource&&r.text(t.t(e.utils.unwrapObservable(s.readerResource))),s.cssContent&&"on"==s.cssContent&&(o=$(n).text(),i="cc-make-access-"+u++,$("<style>").text("."+i+':after {content: "'+o+'"}').appendTo("head"),$(n).empty().addClass(i)),$(n).prepend(r)},update:function(n,a){var r=e.utils.unwrapObservable(a());r.readerText?$(n).children(".cc-reader-text").text(e.utils.unwrapObservable(r.readerText)):r.readerResource&&$(n).children(".cc-reader-text").text(t.t(e.utils.unwrapObservable(r.readerResource)))}},e.bindingHandlers.hover={init:function(e,t){},update:function(t,n,a,r,o){var i,s,l,c,u,d=e.utils.unwrapObservable(n());if(i=t.ko_hoverClassValue)if(Array.isArray(i))for(s=0;s<i.length;s+=1)$(t).removeClass(i[s]);else if("object"==typeof i)for(l in i)i.hasOwnProperty(l)&&$(t).removeClass(i[l]);else $(t).removeClass(i);if("object"==typeof d){if("undefined"!=typeof d.if&&!e.utils.unwrapObservable(d.if))return void $(t).hover(function(){},function(){});c=e.utils.unwrapObservable(d.start),u=e.utils.unwrapObservable(d.stop),t.ko__hoverClassValue=e.utils.unwrapObservable(d.class),$(t).hover(function(e){var t,n;if(n=this.ko_hoverClassValue)if(Array.isArray(n))for(s=0;s<n.length;s+=1)$(this).addClass(n[s]);else if("Object"==typeof n)for(t in n)n.hasOwnProperty(t)&&$(this).addClass(n[l]);else $(this).addClass(n);c&&c(r,e)},function(e){var t,n,a;if(n=this.ko_hoverClassValue){if(Array.isArray(n))for(t=0;t<n.length;t+=1)$(this).removeClass(n[t]);else if("Object"==typeof n)for(a in n)n.hasOwnProperty(a)&&$(this).removeClass(n[a]);else $(this).removeClass(n);u&&u(r,e)}})}}},e.bindingHandlers.background={init:function(e,t){},update:function(t,n){var a,r,o,i=e.utils.unwrapObservable(n());if("object"==typeof i){if(a=e.utils.unwrapObservable(i.image),!a)return void $(t).css("background-image","");r="",o=".png",i.extension&&(o=e.utils.unwrapObservable(i.extension),"."!==r.charAt(0)&&(o="."+o)),i.path&&(r=e.utils.unwrapObservable(i.path)||"",r.length>0&&"/"!==r.charAt(r.length-1)&&(r+="/")),$(t).css("background-image","url("+r+a+o+")")}else i?$(t).css("background-image","url("+i+")"):$(t).css("background-image","")}},e.bindingHandlers.draggable={init:function(t,n,a,r,o){var i=e.utils.unwrapObservable(n());if("object"==typeof i){if("undefined"!=typeof i.destroy&&e.utils.unwrapObservable(i.destroy))return;$(t).draggable(i).data("viewModel",r),"undefined"==typeof i.enabled||e.utils.unwrapObservable(i.enabled)||$(t).draggable("disable"),"undefined"!=typeof i.selectable&&e.utils.unwrapObservable(i.selectable)?$(t).enableSelection():$(t).disableSelection()}else $(t).draggable().data("viewModel",r),i?$(t).draggable("enable"):$(t).draggable("disable")},update:function(t,n,a,r,o){var i=e.utils.unwrapObservable(n());if("object"==typeof i){if("undefined"!=typeof i.destroy&&e.utils.unwrapObservable(i.destroy))return void($(t).draggable&&$(t).draggable("destroy"));"undefined"!=typeof i.enabled&&(e.utils.unwrapObservable(i.enabled)?$(t).draggable("enable"):$(t).draggable("disable")),"undefined"!=typeof i.selectable&&e.utils.unwrapObservable(i.selectable)?$(t).enableSelection():$(t).disableSelection(),$(t).draggable("option",i)}else i?$(t).draggable("enable"):$(t).draggable("disable")}},e.bindingHandlers.droppable={init:function(t,n,a,r,o){var i=e.utils.unwrapObservable(n());if("object"==typeof i){if("undefined"!=typeof i.destroy&&e.utils.unwrapObservable(i.destroy))return;$(t).droppable(i).data("viewModel",r),"undefined"==typeof i.enabled||e.utils.unwrapObservable(i.enabled)||$(t).droppable("disable")}else"function"==typeof i&&$(t).droppable({drop:i}).data("viewModel",r)},update:function(t,n,a,r,o){var i=e.utils.unwrapObservable(n());if("object"==typeof i){if("undefined"!=typeof i.destroy&&e.utils.unwrapObservable(i.destroy))return void($(t).droppable&&$(t).droppable("destroy"));$(t).droppable?$(t).droppable("option",i):$(t).droppable(i).data("viewModel",r),"undefined"!=typeof i.enabled&&(e.utils.unwrapObservable(i.enabled)?$(t).droppable("enable"):$(t).droppable("disable"))}else"function"==typeof i&&$(t).droppable({drop:i}).data("viewModel",r)}},e.bindingHandlers.selectable={init:function(t,n,a,r,o){var i=e.utils.unwrapObservable(n());if("object"==typeof i){if("undefined"!=typeof i.destroy&&e.utils.unwrapObservable(i.destroy))return;$(t).selectable(i).data("viewModel",r),"undefined"==typeof i.enabled||e.utils.unwrapObservable(i.enabled)||$(t).selectable("disable"),"undefined"!=typeof i.selectable&&e.utils.unwrapObservable(i.selectable)?$(t).enableSelection():$(t).disableSelection()}else $(t).selectable().data("viewModel",r),i?$(t).selectable("enable"):$(t).selectable("disable")},update:function(t,n,a,r,o){var i=e.utils.unwrapObservable(n());if("object"==typeof i){if("undefined"!=typeof i.destroy&&e.utils.unwrapObservable(i.destroy))return void($(t).selectable&&$(t).selectable("destroy"));"undefined"!=typeof i.enabled&&(e.utils.unwrapObservable(i.enabled)?$(t).selectable("enable"):$(t).selectable("disable")),"undefined"!=typeof i.selectable&&e.utils.unwrapObservable(i.selectable)?$(t).enableSelection():$(t).disableSelection(),$(t).selectable("option",i)}else i?$(t).selectable("enable"):$(t).selectable("disable")}},e.bindingHandlers.slide={init:function(t,n){var a=e.utils.unwrapObservable(n());$(t).toggle(a)},update:function(t,n){var a=e.utils.unwrapObservable(n());a?$(t).slideDown():$(t).slideUp()}},e.bindingHandlers.fade={init:function(t,n){var a=e.utils.unwrapObservable(n());$(t).toggle(a)},update:function(t,n){var a=e.utils.unwrapObservable(n());a?$(t).fadeIn("slow"):$(t).fadeOut("slow")}},e.bindingHandlers.radio={init:function(t,n,a,r,o){var i,s,l,c;if(c=n(),!e.isWriteableObservable(c))throw"You must pass an observable or writeable computed";s=$(t),i=s.hasClass("btn")?s:$(".btn",s),l=a(),i.each(function(){var t,n,a;return n=this,t=$(n),a=l.radioValue||t.attr("data-value")||t.attr("value")||t.text(),t.on("click",function(){c(e.utils.unwrapObservable(a))}),e.computed({disposeWhenNodeIsRemoved:n,read:function(){t.toggleClass("active",c()===e.utils.unwrapObservable(a))}})})}},e.bindingHandlers.checkbox={init:function(t,n,a,r,o){var i,s;if(s=n(),!e.isWriteableObservable(s))throw"You must pass an observable or writeable computed";i=$(t),i.on("click",function(){s(!s())}),e.computed({disposeWhenNodeIsRemoved:t,read:function(){i.toggleClass("active",s())}})}},e.bindingHandlers.modalTabbingContraint={init:function(e,t,n,a,r){var o,i,s,l;o=function(t,n){return i=$(e).find(":tabbable"),n==$(i)[0]&&9===t.keyCode&&t.shiftKey?(t.preventDefault(),$(i[i.length-1]).focus(),!1):n!=$(i)[i.length-1]||9!==t.keyCode||t.shiftKey?void 0:(t.preventDefault(),$(i[0]).focus(),!1)},$(e).on("shown.bs.modal",function(){i=$(e).find(":tabbable"),s=$(e).find(":disabled"),l=$(e).find(":hidden"),$.each(i,function(e,t){$(t).on("keydown",function(e){o(e,t)})}),$.each(s,function(e,t){$(t).on("keydown",function(e){o(e,t)})}),$.each(l,function(e,t){$(t).on("keydown",function(e){o(e,t)})})})}},e.bindingHandlers.imageZoom={init:function(t,n){function a(t,n){if(t)for(var a=t.length-1;a>=0;a-=1){var r=e.utils.unwrapObservable(i[t[a]]);"undefined"!=typeof r&&null!==r&&(n[t[a]]=r)}}var o=new r;o.element=t;var i=e.utils.unwrapObservable(n());a(["smallImageUrl","fullImageUrl","imageMetadataDefault","fullImageClass","smallImageClass","magnifierClass","flyoutClass","magnifierPercent","flyoutEnabled","magnifierEnabled","spinnerDelay","replaceImageAtIndex","errorImageUrl"],o),o.index=i.index,o.smallImageUrls=i.smallImageUrls,o.fullImageUrls=i.fullImageUrls,o.imageMetadatas=i.imageMetadatas,o.start()},update:function(e,t,n,a,r){}};var d=function(e){var t="bust="+(new Date).getTime();return e+=e.indexOf("?")!==-1?e.indexOf("?")!==e.length-1?"&"+t:t:"?"+t};e.bindingHandlers.productImageSource={getNoImageSiteSetting:function(t){for(var n=null,a=0;a<t.$parents.length;a++)if(e.isObservable(t.$parents[a].site)){n=e.unwrap(t.$parents[a].site().noImageSrc);break}return n},init:function(t,n,a,r,o){var i,s,l,c,u,d=e.utils.unwrapObservable(n());"object"==typeof d&&"IMG"===t.nodeName&&(i=e.utils.unwrapObservable(d.src),s=e.utils.unwrapObservable(d.errorSrc),l=e.bindingHandlers.productImageSource.getNoImageSiteSetting(o),c=l&&l.length>0?l:s,i&&c&&(u=new Image,u.src=c))},update:function(t,n,a,r,o){var i,l,c,u,d,p,f,b,m,v,h,g,$,w="",y=e.utils.unwrapObservable(n());if("object"==typeof y&&"IMG"===t.nodeName){if(c=e.utils.unwrapObservable(y.src),i=e.utils.unwrapObservable(y.imageType),i||(i="medium"),c){switch(i){case"full":l=e.utils.unwrapObservable(c.primaryFullImageURL);break;case"large":l=e.utils.unwrapObservable(c.primaryLargeImageURL);break;case"medium":l=e.utils.unwrapObservable(c.primaryMediumImageURL);break;case"small":l=e.utils.unwrapObservable(c.primarySmallImageURL);break;case"thumb":l=e.utils.unwrapObservable(c.primaryThumbImageURL);break;default:l=e.utils.unwrapObservable(c.primaryMediumImageURL)}h=e.utils.unwrapObservable(y.outputFormat),g=e.utils.unwrapObservable(y.quality),$=e.utils.unwrapObservable(y.alphaChannelColor),h&&(w="&"+s.IMAGE_OUTPUT_FORMAT+"="+h),g&&(w=w+"&"+s.IMAGE_QUALITY+"="+g),$&&(w=w+"&"+s.IMAGE_ALPHA_CHANNEL_COLOR+"="+$),l&&w&&(l+=w)}else l=y.errorSrc;return f=e.utils.unwrapObservable(c.primaryImageAltText),b=e.utils.unwrapObservable(c.primaryImageTitle),u=e.utils.unwrapObservable(y.errorSrc),d=e.bindingHandlers.productImageSource.getNoImageSiteSetting(o),p=d&&d.length>0?d:u,l!==u&&"/img/no-image.jpg"!==l||(l=p),f||(f=e.utils.unwrapObservable(y.alt)),b||(b=e.utils.unwrapObservable(y.title)),m=e.utils.unwrapObservable(y.errorAlt),v=e.utils.unwrapObservable(y.onerror),p?void(l?(f&&(t.alt=f),b&&(t.title=b),t.onerror=function(){var e=new Image;e.onload=function(){t.src=p,v&&v(t),t.onerror=""},e.onerror=function(){var e=new Image;e.onload=function(){t.src=e.src,v&&v(t),t.onerror=""},e.onerror=function(){t.src="/img/no-image.jpg",v&&v(t),t.onerror=""},e.src=u},e.src=p,m&&(t.alt=m)},t.src=l):(t.src=p,m?t.alt=m:f&&(t.alt=f),v&&v(t))):(t.src=l,f&&(t.alt=f),void(b&&(t.title=b)))}}},e.bindingHandlers.carouselSwipe={init:function(e,t,n){var a=$(e);n().Options||{};a.unbind("swipeleft"),a.unbind("swiperight"),a.carousel.interval=!1,a.on("swipeleft",function(e){a.carousel("next"),a.carousel({interval:!1})}),a.on("swiperight",function(e){a.carousel("prev"),a.carousel({interval:!1})})}},e.bindingHandlers.tabTrap={constrain:function(e){var t,n=$(e).find(":tabbable");n.length;n.each(function(n){var a;$(this).hasClass("cc-tab-trapped")||($(this).addClass("cc-tab-trapped"),$(this).on("keydown",function(n){t=$(e).find(":tabbable"),9===n.keyCode&&(n.shiftKey?(a=parseInt(t.index($(this)),10)-1,a<0&&(n.preventDefault(),t[t.length-1].focus())):(a=parseInt(t.index($(this)),10)+1,a===t.length&&(n.preventDefault(),t[0].focus())))}))})}},e.bindingHandlers.ccForm={init:function(e,t){var n=$(e),a=t().action,r=["INPUT","SELECT"];n.on("keydown",function(e){if("13"==e.which&&r.indexOf(e.target.tagName)!==-1)return"function"==typeof a?a():"string"==typeof a&&$(a).trigger("click"),!1})}},e.bindingHandlers.ccValidation={init:function(e,t,n){},update:function(t,n,a){e.bindingHandlers.validationMessage.update(t,n,a),e.isObservable(n().error)?$("#cc-aria-announce").text(n().error()):$("#cc-aria-announce").text(n().error)}},e.bindingHandlers.handleFocusin={init:function(t,n,a){var r=e.utils.unwrapObservable(n()),o=r.applyClass?r.applyClass:"cc-showhidden",i=r.applyTo;$(t).on("focusin mouseover",function(e){$(t).find(i).addClass(o)}).on("focusout mouseout",function(e){$.contains(t,document.activeElement)||$(t).find(i).removeClass(o)})}}});
//# sourceMappingURL=ko-extensions.js.map