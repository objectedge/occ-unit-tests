define("sfExceptionHandler",["knockout","ccRestClient","ccConstants","ccClientErrorCodes","pubsub","pageViewTracker"],function(r,o,e,n,i,t){"use strict";function s(){}var a,E,R,c,d=[],l=0,p=10,g={},C=[],u="";return s.prototype.subscribe=function(){a=this,a.logWindowOnErrorBinding=a.logWindowOnError.bind(a),a.logExceptionErrorBinding=a.logExceptionError.bind(a),$.Topic(i.topicNames.EXCEPTION_HANDLER).subscribe(a.logExceptionErrorBinding),$.Topic(i.topicNames.ONERROR_EXCEPTION_HANDLER).subscribe(a.logWindowOnErrorBinding)},s.prototype.getErrorCode=function(r){return r?(r=r.toLowerCase(),R=r==="RangeError".toLowerCase()||r==="RangeError:".toLowerCase()?n.RANGE_ERROR:r==="TypeError".toLowerCase()||r==="TypeError:".toLowerCase()?n.TYPE_ERROR:r==="SyntaxError".toLowerCase()||r==="SyntaxError:".toLowerCase()?n.SYNTAX_ERROR:r==="ReferenceError".toLowerCase()||r==="ReferenceError:".toLowerCase()?n.REFERENCE_ERROR:r==="EvalError".toLowerCase()||r==="EvalError:".toLowerCase()?n.EVAL_ERROR:r==="URIError".toLowerCase()||r==="URIError:".toLowerCase()?n.URI_ERROR:n.GENERIC_ERROR):R=n.NO_SPECIFIED_ERROR,R},s.prototype.logExceptionError=function(r){a=this,a.errorCode=a.getErrorCode(r.name),a.errorUrl=location.href,a.errorLine="",a.errorMessage="";var o;for(o in r)"fileName"===o?a.errorUrl=r[o]:"lineNumber"===o&&(a.errorLine=r[o]);a.errorMessage=r.toString(),!a.errorLine&&r.line>0&&(a.errorLine=r.line),a.sendErrorReport(a.errorMessage,a.errorLine,a.errorUrl,a.errorCode)},s.prototype.logWindowOnError=function(r,o,e,n,i){a=this;var t,s,E,R=r.split(" ");for(s=0,E=R.length;s<E;s+=1)if(R[s].indexOf("Error")>=0){t=R[s];break}a.errorCode=a.getErrorCode(t),a.errorCode||(a.errorCode=" "),r?a.errorMessage=r:a.errorMessage=" ",o?a.errorUrl=o:a.errorUrl=" ",e?a.errorLine=e:a.errorLine=" ",n?a.errorCol=n:a.errorCol=" ",i&&(a.errorObj=i),a.sendErrorReport(a.errorMessage,a.errorLine,a.errorUrl,a.errorCode,a.errorCol,a.errorObj)},navigator.findBrowserVersion=function(){var r,o,e=navigator.appName,n=navigator.userAgent;return o=n.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i),o&&null!==(r=n.match(/version\/([\.\d]+)/i))&&(o[2]=r[1]),o=o?[o[1],o[2]]:[e,navigator.appVersion,"-?"]}(),s.prototype.sendErrorReport=function(r,o,e,n,i,s){var a=t.getVisitorId(),R=t.getVisitId(),c=window.location.href,g=null;s&&(g=s.stack),"undefined"!=typeof r&&l<p&&(l+=1,E={message:r,url:e,browserURL:c,line:o,column:i,osVersion:window.navigator.platform,locale:window.navigator.language,browserVersion:navigator.findBrowserVersion[0]+" "+navigator.findBrowserVersion[1],time:(new Date).toISOString(),clientErrorCode:n,visitorId:a,visitId:R,stack:g},u=n+"#"+c+"#"+e+"#"+o+"#"+i,C.indexOf(u)<0&&(C.push(u),d.push(E),this.reportErrorsToServer()))},s.prototype.reportErrorsToServer=function(){d.length>0&&(c=e.ENDPOINT_ERRORLOGS_CREATE_ERRORLOG,g={},g={clientSideErrors:d},o.request(c,g,this.sendSuccess,this.sendError),d=[],l=0)},s.prototype.sendSuccess=function(r){},s.prototype.sendError=function(r){},s});
//# sourceMappingURL=sf-exception-handler.js.map