define("currencyHelper",["knockout","ccRestClient","ccConstants","numberFormatHelper","pubsub"],function(r,e,t,i,c){"use strict";function s(){return this.currencyObject=r.observable(null),this.currencyMapObject=r.observable(null),this.setFractionalDigits=r.observable(null),this.currencies=r.observableArray([]),this.currenciesLoaded=!1,this.priceListGroups=r.observableArray([]),this.defaultPriceListGroup=null,this.priceListGroupsLoaded=!1,this.getCurrencyMapCurrenciesBinding=this.getCurrencyMapCurrencies.bind(this),$.Topic(c.topicNames.PRICE_LIST_GROUP_UPDATE).subscribe(this.getCurrencyMapCurrenciesBinding),$.Topic(c.topicNames.ADMIN_CONTENT_LANGUAGE_CHANGED).subscribe(this.getCurrencyMapCurrenciesBinding),this}return s.prototype.DECIMAL_NUMBER_FORMAT="decimal",s.prototype.getCurrency=function(r,i){var c=t.ENDPOINT_CURRENCIES_LIST_CURRENCIES,s={};null==r&&(r=this.getCurrencySuccess.bind(this)),null==i&&(i=this.getCurrencyError.bind(this)),e.request(c,s,r,i)},s.prototype.getCurrencySuccess=function(r){this.currencyObject(r.selectedCurrency),this.checkCurrencySymbol()},s.prototype.getCurrencyError=function(r){throw"Not Implemented"},s.prototype.getCurrencies=function(r){var i=t.ENDPOINT_CURRENCIES_LIST_CURRENCIES,c={sort:"currencyCode:asc"};e.request(i,c,r,this.getCurrenciesError.bind(this))},s.prototype.getCurrenciesError=function(r){throw"Not Implemented"},s.prototype.getPriceListGroups=function(r){var i=t.ENDPOINT_LIST_PRICE_LIST_GROUPS,c={includeDeleted:"true"};e.request(i,c,r,this.getPriceListGroupsError.bind(this))},s.prototype.getPriceListGroupsError=function(r){throw"Not Implemented"},s.prototype.getPLGCurrencies=function(r){this.getCurrencies(function(e){this.currencies(e.items),this.currenciesLoaded=!0,this.priceListGroupsLoaded&&this.formatCurrenciesForList(r)}.bind(this)),this.getPriceListGroups(function(e){this.priceListGroups(e.items),this.defaultPriceListGroup=e.defaultPriceListGroup,this.priceListGroupsLoaded=!0,this.currenciesLoaded&&this.formatCurrenciesForList(r)}.bind(this))},s.prototype.formatCurrenciesForList=function(r){var e,t,i=this.priceListGroups(),c=[];r:for(e=0;e<i.length;e++){var s={};for(s.repositoryId=i[e].currency.repositoryId,s.currencyCode=i[e].currency.currencyCode,t=0;t<c.length;t++)if(c[t].repositoryId===i[e].currency.repositoryId)continue r;for(s.selectListDisplayName=i[e].currency.currencyCode+" - "+i[e].currency.displayName,s.fractionalDigits=i[e].currency.fractionalDigits,s.repositoryId===this.defaultPriceListGroup.locale&&(s.isDefault=!0),t=0;t<this.currencies().length;t++)this.currencies()[t].currencyCode===i[e].currency.currencyCode&&(s.selectListDisplayName=i[e].currency.currencyCode+" - "+this.currencies()[t].displayName);c.push(s)}c.sort(function(r,e){return r.selectListDisplayName.localeCompare(e.selectListDisplayName)}),r(c)},s.prototype.checkCurrencySymbol=function(){this.currencyObject().symbol.match(/^[0-9a-zA-Z]+$/)&&(this.currencyObject().symbol=this.currencyObject().symbol+" ")},s.prototype.handleFractionalDigits=function(r,e){var t;return t="number"==typeof e?e:this.currencyObject()?this.currencyObject().fractionalDigits:2,null===r||""===r?r:Number(r).toFixed(t)},s.prototype.handleFractionalDigitsAndLocale=function(r){var e;return e=null!==this.setFractionalDigits()?this.setFractionalDigits():this.currencyObject()?this.currencyObject().fractionalDigits:2,null==r||""===r?r:r=i.formatNumber(r,e,this.DECIMAL_NUMBER_FORMAT)},s.prototype.getCurrencyMapCurrencies=function(){var r={};r.defaultFirst=!0,e.request(t.ENDPOINT_LIST_PRICE_LIST_GROUPS,r,this.getCurrencyMapCurrenciesSuccess.bind(this),this.getCurrencyMapCurrenciesError.bind(this))},s.prototype.getCurrencyMapCurrenciesSuccess=function(r){r.defaultPriceListGroupId=r.defaultPriceListGroup.id,$.each(r.items,function(e){r.items[e].isDefaultPriceListGroup=r.items[e].id===r.defaultPriceListGroup.id}),this.currencyMapObject(r)},s.prototype.getCurrencyMapCurrenciesError=function(r){},new s});
//# sourceMappingURL=currency-helper.js.map